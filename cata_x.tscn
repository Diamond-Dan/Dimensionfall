[gd_scene load_steps=24 format=3 uid="uid://c1fqtjd1cxbtu"]

[ext_resource type="PackedScene" uid="uid://mvp8pvy00mrm" path="res://level.tscn" id="1_li185"]
[ext_resource type="PackedScene" uid="uid://b2r6nh12wv41k" path="res://enemy.tscn" id="2_ao3di"]
[ext_resource type="Script" path="res://Scripts/BuildManager.gd" id="5_ugvie"]
[ext_resource type="Script" path="res://Scripts/player.gd" id="7_gelpj"]
[ext_resource type="Texture2D" uid="uid://8uwpq1ai8qi4" path="res://Textures/survivor.png" id="8_rg7i2"]
[ext_resource type="Script" path="res://Scripts/Camera.gd" id="9_li818"]
[ext_resource type="Script" path="res://Scripts/PlayerShooting.gd" id="10_amy2f"]
[ext_resource type="AudioStream" uid="uid://gdwwxc0yvg5g" path="res://Sounds/Weapons/Shooting/pistol_shot.wav" id="11_sif7w"]
[ext_resource type="AudioStream" uid="uid://cfmgnsm10aj4i" path="res://Sounds/Weapons/Reloading/pistol_reload_sound.mp3" id="12_wlvdj"]
[ext_resource type="PackedScene" uid="uid://clhj525tmme3k" path="res://hud.tscn" id="12_ycq8c"]
[ext_resource type="PackedScene" uid="uid://doyjc25kl7104" path="res://bullet_line.tscn" id="17_1aft6"]
[ext_resource type="AudioStream" uid="uid://b1q36r8e5wmen" path="res://Sounds/Music/Just in Reach of Sirens.mp3" id="17_5dq1b"]

[sub_resource type="Environment" id="Environment_kc02k"]
background_mode = 1
fog_sky_affect = 0.0

[sub_resource type="NavigationMesh" id="NavigationMesh_3licq"]
vertices = PackedVector3Array(1.8, 1.25, 0.3, 4.3, 3, 0.3, 4.3, 3, -0.3, 1.8, 1.25, -0.3, 3.3, 2.75, 0.3, 3.3, 2.75, -0.3, -46.3, 1, 18.5, -46.3, 1, 26.4, -22.5, 1, 50.3, -1.7, 1, 2.4, -0.299999, 1, 2.3, 1.8, 1, 0.8, 1.8, 1.25, 0.3, 1.8, 1, 0.8, -0.299999, 1, 2.3, -0.200001, 1, 3.7, 17.3, 1, 12.5, 17.3, 1, 6.2, 4.6, 1, 0.8, -46.3, 1, 18.5, -22.5, 1, 50.3, -14.5, 1, 50.3, 17.3, 1, 25.1, -1.6, 1, 3.8, -21.9, 1, -13.3, -1.7, 1, 2.4, 1.8, 1.25, 0.3, 1.8, 1.25, -0.3, -1.7, 1, 2.4, 1.8, 1.25, -0.3, 1.8, 1, -0.7, -14.5, 1, 50.3, -6.6, 1, 50.3, 17.3, 1, 25.1, -40.2, 1, -13.3, -46.3, 1, -13.3, -46.3, 1, -5.4, 9.3, 1, 50.3, 17.3, 1, 50.3, 17.3, 1, 44, -46.3, 1, 42.3, -46.3, 1, 50.3, -38.4, 1, 50.3, 17.3, 1, 0, 4.8, 1, 0, 4.8, 1, 0.6, 1.8, 1, -0.7, 2.6, 1, -0.7, 2.6, 1, -13.3, 17.3, 1, 0, 4.8, 1, 0.6, 4.6, 1, 0.8, 17.3, 1, 6.2, 1.8, 1, -0.7, 2.6, 1, -13.3, -3.6, 1, -13.3, -1.7, 1, 2.4, 17.3, 1, 25.1, 17.3, 1, 18.8, -1.6, 1, 3.8, -34.1, 1, -13.3, -40.2, 1, -13.3, -46.3, 1, -5.4, 9.3, 1, 50.3, 17.3, 1, 44, 17.3, 1, 37.7, -46.3, 1, 34.4, -30.4, 1, 50.3, -22.5, 1, 50.3, -46.3, 1, 26.4, -1.6, 1, 3.8, -1.7, 1, 2.4, -3.6, 1, -13.3, -9.7, 1, -13.3, -1.6, 1, 3.8, -15.8, 1, -13.3, -21.9, 1, -13.3, -46.3, 1, 34.4, -46.3, 1, 42.3, -38.4, 1, 50.3, -30.4, 1, 50.3, -21.9, 1, -13.3, -28, 1, -13.3, -46.3, 1, 2.6, -46.3, 1, 10.5, 1.4, 1, 50.3, 17.3, 1, 31.4, 17.3, 1, 25.1, -6.6, 1, 50.3, -28, 1, -13.3, -34.1, 1, -13.3, -46.3, 1, -5.4, -46.3, 1, 2.6, 1.4, 1, 50.3, 9.3, 1, 50.3, 17.3, 1, 37.7, 17.3, 1, 31.4, 17.3, 1, 12.5, -0.200001, 1, 3.7, -1.6, 1, 3.8, 17.3, 1, 18.8, -1.6, 1, 3.8, -9.7, 1, -13.3, -15.8, 1, -13.3, -21.9, 1, -13.3, -46.3, 1, 10.5, -46.3, 1, 18.5, 2.6, 1, -0.7, 3.9, 1, -0.7, 3.9, 1, -13.3, 2.6, 1, -13.3, 17.3, 1, -6.7, 17.3, 1, -13.3, 10.6, 1, -13.3, 4.7, 1, -0.7, 4.8, 1, 0, 17.3, 1, 0, 17.3, 1, -6.7, 10.6, 1, -13.3, 3.9, 1, -13.3, 3.9, 1, -13.3, 3.9, 1, -0.7, 4.7, 1, -0.7, -1.3, 2, 2.7, -1.3, 2, 3.4, -0.700001, 2, 3.4, -0.700001, 2, 2.7)
polygons = [PackedInt32Array(1, 4, 2), PackedInt32Array(2, 4, 5), PackedInt32Array(5, 4, 0), PackedInt32Array(5, 0, 3), PackedInt32Array(8, 7, 6), PackedInt32Array(11, 10, 12), PackedInt32Array(12, 10, 9), PackedInt32Array(14, 13, 15), PackedInt32Array(15, 13, 18), PackedInt32Array(15, 18, 17), PackedInt32Array(15, 17, 16), PackedInt32Array(20, 19, 21), PackedInt32Array(21, 19, 24), PackedInt32Array(21, 24, 23), PackedInt32Array(21, 23, 22), PackedInt32Array(27, 26, 25), PackedInt32Array(30, 29, 28), PackedInt32Array(33, 32, 31), PackedInt32Array(36, 35, 34), PackedInt32Array(39, 38, 37), PackedInt32Array(42, 41, 40), PackedInt32Array(45, 44, 43), PackedInt32Array(48, 47, 46), PackedInt32Array(50, 49, 51), PackedInt32Array(51, 49, 52), PackedInt32Array(54, 53, 55), PackedInt32Array(55, 53, 56), PackedInt32Array(57, 59, 58), PackedInt32Array(62, 61, 60), PackedInt32Array(65, 64, 63), PackedInt32Array(67, 66, 68), PackedInt32Array(68, 66, 69), PackedInt32Array(71, 70, 72), PackedInt32Array(72, 70, 73), PackedInt32Array(76, 75, 74), PackedInt32Array(78, 77, 79), PackedInt32Array(79, 77, 80), PackedInt32Array(82, 81, 83), PackedInt32Array(83, 81, 84), PackedInt32Array(86, 85, 87), PackedInt32Array(87, 85, 88), PackedInt32Array(90, 89, 91), PackedInt32Array(91, 89, 92), PackedInt32Array(95, 94, 96), PackedInt32Array(96, 94, 93), PackedInt32Array(98, 97, 99), PackedInt32Array(99, 97, 100), PackedInt32Array(103, 102, 101), PackedInt32Array(106, 105, 104), PackedInt32Array(110, 109, 107), PackedInt32Array(107, 109, 108), PackedInt32Array(111, 113, 112), PackedInt32Array(115, 114, 116), PackedInt32Array(116, 114, 117), PackedInt32Array(117, 114, 118), PackedInt32Array(118, 114, 119), PackedInt32Array(122, 121, 120), PackedInt32Array(126, 125, 123), PackedInt32Array(123, 125, 124)]
geometry_parsed_geometry_type = 1
cell_size = 0.1
agent_radius = 0.2
agent_max_slope = 46.0

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_m3bd2"]
emission_enabled = true
proximity_fade_distance = 0.0

[sub_resource type="BoxMesh" id="BoxMesh_m0nef"]
material = SubResource("StandardMaterial3D_m3bd2")

[sub_resource type="ConvexPolygonShape3D" id="ConvexPolygonShape3D_evp21"]
points = PackedVector3Array(0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5)

[sub_resource type="PrismMesh" id="PrismMesh_wf5px"]
left_to_right = 1.0

[sub_resource type="ConvexPolygonShape3D" id="ConvexPolygonShape3D_qcttf"]
points = PackedVector3Array(0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_7gsdb"]
albedo_color = Color(0, 1, 0, 1)

[sub_resource type="BoxMesh" id="BoxMesh_mc21b"]
size = Vector3(0.3, 1, 0.55)

[sub_resource type="ConvexPolygonShape3D" id="ConvexPolygonShape3D_drnhn"]
points = PackedVector3Array(0.15, 0.5, 0.275, -0.15, 0.5, 0.275, 0.15, -0.5, 0.275, 0.15, 0.5, -0.275, -0.15, 0.5, -0.275, -0.15, -0.5, 0.275, 0.15, -0.5, -0.275, -0.15, -0.5, -0.275)

[sub_resource type="AudioStreamRandomizer" id="AudioStreamRandomizer_136pt"]
streams_count = 1
playback_mode = 1
random_pitch = 1.2
random_volume_offset_db = 0.0
stream_0/stream = ExtResource("11_sif7w")
stream_0/weight = 1.0

[node name="CataX" type="Node3D"]

[node name="TacticalMap" type="Node3D" parent="."]

[node name="WorldEnvironment" type="WorldEnvironment" parent="TacticalMap"]
environment = SubResource("Environment_kc02k")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="TacticalMap"]
visible = false
sky_mode = 1

[node name="NavigationRegion3D" type="NavigationRegion3D" parent="TacticalMap"]
navigation_mesh = SubResource("NavigationMesh_3licq")

[node name="Level" parent="TacticalMap/NavigationRegion3D" instance=ExtResource("1_li185")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -14, 0, -13)

[node name="Level2" parent="TacticalMap/NavigationRegion3D" instance=ExtResource("1_li185")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -14, 0, 19)

[node name="Level3" parent="TacticalMap/NavigationRegion3D" instance=ExtResource("1_li185")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -46, 0, 19)

[node name="Level4" parent="TacticalMap/NavigationRegion3D" instance=ExtResource("1_li185")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -46, 0, -13)

[node name="StaticBody3D" type="StaticBody3D" parent="TacticalMap/NavigationRegion3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -1, 0, 3)

[node name="MeshInstance3D" type="MeshInstance3D" parent="TacticalMap/NavigationRegion3D/StaticBody3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
mesh = SubResource("BoxMesh_m0nef")
skeleton = NodePath("../..")

[node name="CollisionShape3D" type="CollisionShape3D" parent="TacticalMap/NavigationRegion3D/StaticBody3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
shape = SubResource("ConvexPolygonShape3D_evp21")

[node name="StaticBody3D2" type="StaticBody3D" parent="TacticalMap/NavigationRegion3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 4, 1, 0)

[node name="MeshInstance3D" type="MeshInstance3D" parent="TacticalMap/NavigationRegion3D/StaticBody3D2"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
mesh = SubResource("BoxMesh_m0nef")
skeleton = NodePath("../..")

[node name="CollisionShape3D" type="CollisionShape3D" parent="TacticalMap/NavigationRegion3D/StaticBody3D2"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
shape = SubResource("ConvexPolygonShape3D_evp21")

[node name="Ramp1" type="StaticBody3D" parent="TacticalMap/NavigationRegion3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 2, 1, 0)

[node name="MeshInstance3D" type="MeshInstance3D" parent="TacticalMap/NavigationRegion3D/Ramp1"]
mesh = SubResource("PrismMesh_wf5px")

[node name="CollisionShape3D" type="CollisionShape3D" parent="TacticalMap/NavigationRegion3D/Ramp1"]
shape = SubResource("ConvexPolygonShape3D_qcttf")

[node name="Ramp2" type="StaticBody3D" parent="TacticalMap/NavigationRegion3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 3, 2, 0)

[node name="MeshInstance3D" type="MeshInstance3D" parent="TacticalMap/NavigationRegion3D/Ramp2"]
mesh = SubResource("PrismMesh_wf5px")

[node name="CollisionShape3D" type="CollisionShape3D" parent="TacticalMap/NavigationRegion3D/Ramp2"]
shape = SubResource("ConvexPolygonShape3D_qcttf")

[node name="BuildManager" type="Node3D" parent="TacticalMap"]
script = ExtResource("5_ugvie")
hud = NodePath("../../HUD")

[node name="Entities" type="Node3D" parent="TacticalMap"]

[node name="Enemies" type="Node3D" parent="TacticalMap/Entities"]

[node name="Enemy" parent="TacticalMap/Entities/Enemies" instance=ExtResource("2_ao3di")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.216867, 1.41889, 6.75176)

[node name="Projectiles" type="Node3D" parent="TacticalMap/Entities"]

[node name="Player" type="CharacterBody3D" parent="TacticalMap/Entities" groups=["Players"]]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.1205, 0)
floor_constant_speed = true
script = ExtResource("7_gelpj")

[node name="Camera3D" type="Camera3D" parent="TacticalMap/Entities/Player" groups=["Camera"]]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, 0, 18.9245, -0.0113735)
projection = 1
current = true
size = 50.0
script = ExtResource("9_li818")

[node name="MeshInstance3D" type="MeshInstance3D" parent="TacticalMap/Entities/Player"]
visible = false
material_override = SubResource("StandardMaterial3D_7gsdb")
mesh = SubResource("BoxMesh_mc21b")

[node name="CollisionShape3D" type="CollisionShape3D" parent="TacticalMap/Entities/Player"]
shape = SubResource("ConvexPolygonShape3D_drnhn")

[node name="OmniLight3D" type="OmniLight3D" parent="TacticalMap/Entities/Player"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.17078, 0)
light_energy = 0.587
shadow_enabled = true
omni_range = 15.355
omni_attenuation = 0.000270892

[node name="SpotLight3D" type="SpotLight3D" parent="TacticalMap/Entities/Player"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, 0, 0.459921, 0)
visible = false
light_energy = 1.342
shadow_enabled = true
spot_range = 8.104
spot_attenuation = 0.00961836
spot_angle = 83.32
spot_angle_attenuation = 0.183011

[node name="Sprite3D" type="Sprite3D" parent="TacticalMap/Entities/Player"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.277026, 0)
pixel_size = 0.002
billboard = 1
double_sided = false
no_depth_test = true
texture = ExtResource("8_rg7i2")

[node name="Shooting" type="Node3D" parent="TacticalMap/Entities/Player" node_paths=PackedStringArray("attack_cooldown", "reload_timer", "shoot_audio_player", "reload_audio_player")]
script = ExtResource("10_amy2f")
bullet_damage = 25.0
bullet_line_scene = ExtResource("17_1aft6")
attack_cooldown = NodePath("AttackCD")
reload_timer = NodePath("ReloadTime")
player = NodePath("..")
shoot_audio_player = NodePath("ShootAudio")
shoot_audio_randomizer = SubResource("AudioStreamRandomizer_136pt")
reload_audio_player = NodePath("ReloadAudio")

[node name="AttackCD" type="Timer" parent="TacticalMap/Entities/Player/Shooting"]
one_shot = true

[node name="ReloadTime" type="Timer" parent="TacticalMap/Entities/Player/Shooting"]
wait_time = 5.0
one_shot = true

[node name="ShootAudio" type="AudioStreamPlayer3D" parent="TacticalMap/Entities/Player/Shooting"]
stream = ExtResource("11_sif7w")
bus = &"Sounds"

[node name="ReloadAudio" type="AudioStreamPlayer3D" parent="TacticalMap/Entities/Player/Shooting"]
stream = ExtResource("12_wlvdj")
bus = &"Sounds"

[node name="HUD" parent="." instance=ExtResource("12_ycq8c")]

[node name="Music" type="AudioStreamPlayer" parent="."]
stream = ExtResource("17_5dq1b")
volume_db = -20.15
bus = &"Music"

[node name="TestCamera" type="Camera3D" parent="."]
transform = Transform3D(-0.946576, 0, -0.32248, 0, 1, 0, 0.32248, 0, -0.946576, 2.15246, 2.21176, -2.99642)

[connection signal="construction_chosen" from="HUD" to="TacticalMap/BuildManager" method="_on_hud_construction_chosen"]
